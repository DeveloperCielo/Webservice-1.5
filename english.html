<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <title>Webservice integration 1.5</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <link href="https://www.cielo.com.br/wps/contenthandler/!ut/p/digest!3SvhW8ACOLyj_90YHxPhKQ/war/cielo-tema/themes/estatico/images/favicon.ico" rel="shortcut icon" type="image/x-icon" />

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="javascripts/all.js" type="text/javascript"></script>

    <script>
    $(function() {
        setupLanguages(["xml"]);
    });
    </script>
    <script async src='//www.google-analytics.com/analytics.js'></script>
    <script>
    window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;

    ga('create', 'UA-8516386-7', {'cookieDomain': 'auto',
    'alwaysSendReferrer': true});

    ga("set", "transport", "beacon");
    ga('send', 'pageview');
    </script>
</head>

<body class="english">
    <a href="#" id="nav-button">
        <span>
            NAV
            <img src="images/navbar.png" />
        </span>
    </a>
    <div class="tocify-wrapper">
        <ul class="languages">
            <li class="english"><a href="english.html" title="English version">English version</a></li>
            <li class="portuguese"><a href="index.html" title="Versão em português">Versão em português</a></li>
        </ul>
        <img src="images/logo.png" />
        <div class="lang-selector">
            <a href="#" data-language-name="xml">XML</a>
        </div>
        <div class="search">
            <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
        <div id="toc">
        </div>
        <div class="links-footer">
            <ul class="link-list">
                <li class="cielo"><a href="https://www.cielo.com.br/">Cielo</a></li>
                <li class="github"><a href="https://github.com/developercielo">Cielo</a></li>
                <li class="desenvolvedores"><a href="https://www.cielo.com.br/desenvolvedores">Cielo</a></li>
            </ul>
        </div>
    </div>
    <div class="page-wrapper">
        <div class="dark-box"></div>
        <div class="content">
                <h1 id="webservice-integration-1.5">Webservice integration 1.5</h1>

<p>The purpose of this documentation is to orientate the developer about how integrate with Cielo Webservice, describing its functionalities, the methods to be used, list information to be sent and received and provide examples. </p>

<p>The integration mechanism with Cielo E-commerce is simple, so that are necessary only an intermediate knowledge in programming language for Web, HTTP/HTTP requisitions and handling XML archive to implant Cielo E-commerce solution with success.</p>

<p>To carry out a test on homolagation it’s not necessary to log/register at Cielo, however to sell on internet it’s necessary to register on Cielo link: <a href="https://www.cielo.com.br/sitecielo/e-commerce/credenciamento-ecommerce.html">https://www.cielo.com.br/sitecielo/e-commerce/credenciamento-ecommerce.html</a>.</p>

<p>After conclude the registration and receive the instructions, you need to develop the integration using this documentation as a guide. Once the integration is completed, it’s necessary to fill the homologation form fully and then send it to Cielo E-commerce Web Support that will inform the secure key to the establishment.</p>

<p>Finally, after the development, to start the operation on production environment, first, it&rsquo;s necessary start the homologation at Cielo.</p>

<aside class="notice">Look at section [Homologation](#Homologation) to more instruction about the homologation process</aside>

<h2 id="cielo-support">Cielo Support</h2>

<p>After reading this documentation, if you still have questions (technical or not), you can check Cielo technical support 24 hours per day, 7 days of week, in Portuguese and English, in the following contacts:</p>

<ul>
<li>+55 4002-9700 – <em>Capitals and Metropolitan regions</em></li>
<li>+55 0800-570-1700 – <em>Others localities</em></li>
<li>+55 11 2860-1348 – <em>International</em>

<ul>
<li>Option 1: <em>Technical support</em></li>
<li>Option 2: <em>E-commerce credential</em></li>
</ul></li>
<li>Email: <a href="mailto:cieloecommerce@cielo.com.br">cieloecommerce@cielo.com.br</a></li>
</ul>

<h2 id="glossary">Glossary</h2>

<p>To facilitate the understanding, we listed below a small glossary with the main terms related to e-commerce, card market and acquiring services:</p>

<ul>
<li><strong>Authentication</strong>: process to ensure that the buyer is really who says (authentic holder), generally it happens at the issuing bank using the digital token or security key card.</li>
<li><strong>Authorization</strong>: process to verify if a purchase can be realized or not with a card. In this moment several verification are done with the card and the holder (Funds availability, blocked account, blockades, etc), It&rsquo;s also in this moment that the card limit is cross-checked with the transaction value.</li>
<li><strong>Cancellation</strong>: process to cancel the purchase that has been realized with card.</li>
<li><strong>Capture</strong>: process to confirm the authorization that has been realized previously. Only after the capture, the cardholder can check this in his bank statement or invoice.</li>
<li><strong>Key access</strong>: it&rsquo;s a specific secure code for each store, created by Cielo, and used to realized an authentication and communication in all messages exchanged with Cielo. It&rsquo;s also known as production key and data key.</li>
<li><strong>Buyer</strong>: who effectives the purchase at online store.</li>
<li><strong>Emitter</strong> (or Issuing Bank): it&rsquo;s the financial institution that issues credit card, debt or voucher.</li>
<li><strong>Commercial establishment or EC</strong>: entity that responses for online store.</li>
<li><strong>Payment gateway</strong>: company responsible for technical integration and for processing transactions.</li>
<li><strong>Credential number</strong>: it&rsquo;s an identifier number that the retailer receives after registered at Cielo.</li>
<li><strong>Holder</strong>: it&rsquo;s the person who carries the card in the moment of purchase.</li>
<li><strong>Security Code</strong>: international program of MasterCard to allow the buyer authentication in the moment of purchase in e-commerce environment.</li>
<li><strong>TID (Transaction Identifier)</strong>: a code composed by 20 characters that identifies only Cielo E-commerce transactions.</li>
<li><strong>Transaction</strong>: it&rsquo;s the purchase order to cardholder at Cielo.</li>
<li><strong>VBV (Verified by Visa)</strong>: International Program at Visa that allows the buyer authentication in the moment of purchase in e-commerce environment.</li>
</ul>

<aside class="notice">Access http://www.mastercard.com.br/securecode to more details about SecureCode</aside>

<aside class="notice">Access http://www.verifiedbyvisa.com.br  to more details about VBV</aside>

<h2 id="products-and-card-issuers-supported">Products and Card Issuers supported</h2>

<p>The current version of Cielo Webservice has support to the following products and card issuers:</p>

<table><thead>
<tr>
<th>Card Issuer</th>
<th>Lump Sum</th>
<th>Credit card installments</th>
<th>Debt</th>
<th>Voucher</th>
</tr>
</thead><tbody>
<tr>
<td>Visa</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td><em>No</em></td>
</tr>
<tr>
<td>Master Card</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td><em>No</em></td>
</tr>
<tr>
<td>American Express</td>
<td>Yes</td>
<td>Yes</td>
<td><em>No</em></td>
<td><em>No</em></td>
</tr>
<tr>
<td>Elo</td>
<td>Yes</td>
<td>Yes</td>
<td><em>No</em></td>
<td><em>No</em></td>
</tr>
<tr>
<td>Diners Club</td>
<td>Yes</td>
<td>Yes</td>
<td><em>No</em></td>
<td><em>No</em></td>
</tr>
<tr>
<td>Discover</td>
<td>Yes</td>
<td><em>No</em></td>
<td><em>No</em></td>
<td><em>No</em></td>
</tr>
<tr>
<td>JCB</td>
<td>Yes</td>
<td>Yes</td>
<td><em>No</em></td>
<td><em>No</em></td>
</tr>
<tr>
<td>Aura</td>
<td>Yes</td>
<td>Yes</td>
<td><em>No</em></td>
<td><em>No</em></td>
</tr>
</tbody></table>

<h1 id="overview">Overview</h1>

<p>In this documentation we will be present an overview of Cielo E-commerce and the technical mechanism of Webservice integration format (named in the previous version as &ldquo;Buy Page Loja&rdquo;).</p>

<p>To more information about integration at Checkout Cielo format (named in the previous versions as Buy Page Cielo or Integrated Solution) access: <a href="https://www.cielo.com.br/ecommerce">https://www.cielo.com.br/ecommerce</a>.</p>

<p>For all purchase orders, the goal is convert it in a sale. A sale using a card can be characterized as an authorized and captured transaction.</p>

<aside class="warning">An authorized transaction only creates credit to the retailer if it can be captured (or confirmed).</aside>

<h2 id="solutions-characteristics:">Solutions characteristics:</h2>

<p>The Webservice solution at Cielo E-commerce platform has been developed based on XML technology, a market pattern and independent of technologies used by our customers. In this way, it&rsquo;s possible to integrate it by using the various programing languages, like: ASP, ASP.NEt, Java, PHP, Ruby, Python, etc.</p>

<p>Among others characteristics, the most highlighted attributes of Cielo E-commerce platform are:</p>

<ul>
<li><strong>No proprietary application</strong>: it&rsquo;s not necessary to install application at online store environment in any case.</li>
<li><strong>Simplicity</strong>: the protocol used is purely HTTP, without necessity of using SOAP.</li>
<li><strong>Registering facility</strong>: the customer&rsquo;s credential information (affiliation number and access key) transits in common fields of XML, without necessity of special attributes, as SOAP Header.</li>
<li><strong>Security</strong>: the information exchange always happens between the Store Server and Cielo, in other words, without the buyer’s browser.</li>
</ul>

<h2 id="consideration-about-integration">Consideration about integration</h2>

<ul>
<li>All the Web Service requests at Cielo must contain a retailer&rsquo;s link authentication, composed by credential number and access key.</li>
<li>The store registration must be active on Cielo.</li>
<li>You must define appropriate deadline ton HTTP requests to Cielo, we recommend 30 seconds.</li>
<li>The Root certificate of certifier entity (CA) of our Web Service must be registered on Truststore that will be used. Because our certifier has a wider market acceptance, probably this is already registered on Truststore of own operational system.</li>
<li>We make available the ecommerce.xsd archive on integration kit to make easier the validation format restriction, size field, types and data domains.</li>
<li>In all messages of data/hour you have to follow the format: yyyy=MM=ddTHH24:mm:ss. Example: 2011-12-21T11:32:45.</li>
<li>The monetary value is always handled as intire values, without representation of decimals place, in such case the last two digits are considered as “centavos”. Example: R$ 1.286,87 is represented as 128687; R$ 1,00 is represented as 100.</li>
</ul>

<aside class="notice">Look the Digital Certificate to information about Cielo Certificates:</aside>

<h2 id="architecture">Architecture</h2>

<p>The integration is realized through the available services as Web Services. The model employed is quite simple: there is an unique URL (endpoint) that receives the POSTs via HTTPs and, depending of XML format sent, a specific operation is realized.</p>

<p>The Web Service request is summarized for:</p>

<ul>
<li>The message in XML format, defined according to the functionality.</li>
<li>The destiny (testing environment or production).</li>
<li>The return on XML format, can be: <code class="prettyprint">&lt;transacao/&gt;</code>, <code class="prettyprint">&lt;retorno-token&gt;</code> or <code class="prettyprint">&lt;erro/&gt;</code>.</li>
</ul>
<pre><code class="highlight plaintext">POST /servicos/ecommwsec.do HTTP/1.1
Host: ecommerce.cielo.com.br
Content-Type: application/x-www-form-urlencoded
Content-Length: length
mensagem=&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;&lt;requisicao-captura id="3e22bdd0-2017-4756-80b7-35a532e6c973" versao="1.2.1"&gt;&lt;tid&gt;10069930690101012005&lt;/tid&gt;&lt;dados-ec&gt;&lt;numero&gt;1006993069&lt;/numero&gt;&lt;chave&gt;25fbb99741c739dd84d7b06ec78c9bac718838630f30b112d033ce2e621b34f3&lt;/chave&gt;&lt;/dados-ec&gt;&lt;valor&gt;3880&lt;/valor&gt;&lt;/requisicao-captura&gt;
</code></pre>

<h2 id="transaction">Transaction</h2>

<p>The main element on Cielo E-commerce is the transaction, created from a HTTP request to Cielo Webservice. The unique identification of Cielo transactions is done through TID field, that is present at message&rsquo;s return of authorization. This field is essential to realize inquires, captures and cancellations.</p>

<p>From transaction creation, it can assume the following status:</p>

<p><img alt="status transações" src="images/status.png" /></p>

<p>The transition of status can be realized through the message exchange between the store and Cielo, or automatically, for example, when an authorized transaction capture deadline expires.</p>

<h1 id="creating-transactions">Creating transactions</h1>

<p>Every transaction on Cielo E-commerce starts through a POST (HTTPS) to Webservice at Cielo with a XML message <code class="prettyprint">&lt;requisicao-transacao&gt;</code>, which group of TAGS defines a transaction configuration:</p>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;requisicao-transacao</span> <span class="na">id=</span><span class="s">"a97ab62a-7956-41ea-b03f-c2e9f612c293"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;dados-ec&gt;</span>
    <span class="nt">&lt;numero&gt;</span>1006993069<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;chave&gt;</span>25fbb997438630f30b112d033ce2e621b34f3<span class="nt">&lt;/chave&gt;</span>
  <span class="nt">&lt;/dados-ec&gt;</span>
  <span class="nt">&lt;dados-portador&gt;</span>
    <span class="nt">&lt;numero&gt;</span>4012001038443335<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;validade&gt;</span>201508<span class="nt">&lt;/validade&gt;</span>
    <span class="nt">&lt;indicador&gt;</span>1<span class="nt">&lt;/indicador&gt;</span>
    <span class="nt">&lt;codigo-seguranca&gt;</span>973<span class="nt">&lt;/codigo-seguranca&gt;</span>
    <span class="nt">&lt;token/&gt;</span>
  <span class="nt">&lt;/dados-portador&gt;</span>
  <span class="nt">&lt;dados-pedido&gt;</span>
    <span class="nt">&lt;numero&gt;</span>178148599<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;valor&gt;</span>1000<span class="nt">&lt;/valor&gt;</span>
    <span class="nt">&lt;moeda&gt;</span>986<span class="nt">&lt;/moeda&gt;</span>
    <span class="nt">&lt;data-hora&gt;</span>2011-12-07T11:43:37<span class="nt">&lt;/data-hora&gt;</span>
    <span class="nt">&lt;descricao&gt;</span>[origem:10.50.54.156]<span class="nt">&lt;/descricao&gt;</span>
    <span class="nt">&lt;idioma&gt;</span>PT<span class="nt">&lt;/idioma&gt;</span>
    <span class="nt">&lt;soft-descriptor/&gt;</span>
    <span class="nt">&lt;taxa-embarque/&gt;</span>
  <span class="nt">&lt;/dados-pedido&gt;</span>
  <span class="nt">&lt;forma-pagamento&gt;</span>
    <span class="nt">&lt;bandeira&gt;</span>visa<span class="nt">&lt;/bandeira&gt;</span>
    <span class="nt">&lt;produto&gt;</span>A<span class="nt">&lt;/produto&gt;</span>
    <span class="nt">&lt;parcelas&gt;</span>1<span class="nt">&lt;/parcelas&gt;</span>
  <span class="nt">&lt;/forma-pagamento&gt;</span>
  <span class="nt">&lt;url-retorno&gt;</span>http://localhost/lojaexemplo/retorno.jsp<span class="nt">&lt;/url-retorno&gt;</span>
  <span class="nt">&lt;autorizar&gt;</span>1<span class="nt">&lt;/autorizar&gt;</span>
  <span class="nt">&lt;capturar&gt;</span>false<span class="nt">&lt;/capturar&gt;</span>
  <span class="nt">&lt;campo-livre&gt;</span>Informações extras<span class="nt">&lt;/campo-livre&gt;</span>
  <span class="nt">&lt;bin&gt;</span>455187<span class="nt">&lt;/bin&gt;</span>
  <span class="nt">&lt;gerar-token&gt;</span>false<span class="nt">&lt;/gerar-token&gt;</span>
  <span class="nt">&lt;avs&gt;</span>
  <span class="cp">&lt;![CDATA[
    &lt;dados-avs&gt;</span>
      <span class="nt">&lt;endereco&gt;</span>Rua Teste AVS<span class="nt">&lt;/endereco&gt;</span>
      <span class="nt">&lt;complemento&gt;</span>Casa<span class="nt">&lt;/complemento&gt;</span>
      <span class="nt">&lt;numero&gt;</span>123<span class="nt">&lt;/numero&gt;</span>
      <span class="nt">&lt;bairro&gt;</span>Vila AVS<span class="nt">&lt;/bairro&gt;</span>
      <span class="nt">&lt;cep&gt;</span>12345-123<span class="nt">&lt;/cep&gt;</span>
    <span class="nt">&lt;/dados-avs&gt;</span>
  ]]&gt;
  <span class="nt">&lt;/avs&gt;</span>
<span class="nt">&lt;/requisicao-transacao&gt;</span>
</code></pre>

<h3 id="root-node">ROOT Node</h3>

<table><thead>
<tr>
<th>Element</th>
<th>Type</th>
<th>Mandatory</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><a href="#dados-ec">dados-ec</a></td>
<td>n/a</td>
<td>Yes</td>
<td>n/a</td>
<td>Establishment data</td>
</tr>
<tr>
<td><a href="#dados-portador">dados-portador</a></td>
<td>n/a</td>
<td>Yes</td>
<td>n/a</td>
<td>Holder data</td>
</tr>
<tr>
<td><a href="#dados-pedido">dados-pedido</a></td>
<td>n/a</td>
<td>Yes</td>
<td>n/a</td>
<td>Order data</td>
</tr>
<tr>
<td><a href="#forma-pagamento">forma-pagamento</a></td>
<td>n/a</td>
<td>Yes</td>
<td>n/a</td>
<td>Payment-method</td>
</tr>
<tr>
<td>url-retorno</td>
<td>alphanumeric</td>
<td>Yes</td>
<td>1..1024</td>
<td>URL of return&rsquo;s page. This page is that one used by Cielo to direct the browser in the end of authentication or authorized. It&rsquo;s not only mandatory  for a direct authorization, but the field must be inserted as <code class="prettyprint">null</code>.</td>
</tr>
<tr>
<td>capturar</td>
<td>Boolean</td>
<td>Yes</td>
<td>n/a</td>
<td><code class="prettyprint">true</code> or <code class="prettyprint">false</code>. Define if a transaction will be captured automatically in case of being authorized.</td>
</tr>
<tr>
<td>campo-livre</td>
<td>alphanumeric</td>
<td>optional</td>
<td>0..128</td>
<td>Free field available to the establishment.</td>
</tr>
<tr>
<td>bin</td>
<td>numeric</td>
<td>optional</td>
<td>6</td>
<td>Six first card numbers.</td>
</tr>
<tr>
<td>gerar-token</td>
<td>Boolean</td>
<td>optional</td>
<td>n/a</td>
<td><code class="prettyprint">true</code> ou <code class="prettyprint">false</code>. Define if the current transaction must create an associate token to card.</td>
</tr>
<tr>
<td>avs#avs</td>
<td>alphanumeric</td>
<td>optional</td>
<td>n/a</td>
<td>String containing a XML block, encapsulated by CDATA, containing required information to realized a service consult.</td>
</tr>
</tbody></table>

<h3 id="dados-ec">dados-ec</h3>

<table><thead>
<tr>
<th>Element</th>
<th>Type</th>
<th>Mandatory</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>numero</td>
<td>numeric</td>
<td>Yes</td>
<td>1..20</td>
<td>Affiliation number of Store with Cielo.</td>
</tr>
<tr>
<td>chave</td>
<td>alphanumeric</td>
<td>Yes</td>
<td>1..100</td>
<td>Store&rsquo;s access key attributed by Cielo.</td>
</tr>
</tbody></table>

<h3 id="dados-portador">dados-portador</h3>

<table><thead>
<tr>
<th>Element</th>
<th>Type</th>
<th>Mandatory</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>numero</td>
<td>numeric</td>
<td>Sim</td>
<td>19</td>
<td>Card number</td>
</tr>
<tr>
<td>validade</td>
<td>Numénumericrico</td>
<td>Sim</td>
<td>6</td>
<td>Card validity of format: yyyymm. Example: 201212 (dec/2012).</td>
</tr>
<tr>
<td>indicador</td>
<td>numeric</td>
<td>Sim</td>
<td>1</td>
<td>Card validity of Secure Code Sending: 0 - Not informed, 1- informed, 2-illegible, 9- Inexistent</td>
</tr>
<tr>
<td>codigo-seguranca</td>
<td>numeric</td>
<td>Condicional</td>
<td>3..4</td>
<td>Security code is required when indicator is <strong>1</strong></td>
</tr>
<tr>
<td>nome-portador</td>
<td>alphanumeric</td>
<td>Opcional</td>
<td>0..50</td>
<td>Holder name</td>
</tr>
<tr>
<td>token</td>
<td>Alfanumérico</td>
<td>Conditional</td>
<td>0..100</td>
<td>Token must be used in replacement to card data to direct authorization or recurrent. It&rsquo;s not allowed to send a token with the card information in the same transaction.</td>
</tr>
</tbody></table>

<h3 id="dados-pedido">dados-pedido</h3>

<table><thead>
<tr>
<th>Element</th>
<th>Type</th>
<th>Mandatory</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>numero</td>
<td>Alphanumeric</td>
<td>Yes</td>
<td>1..20</td>
<td>Order number of store. We recommend just one number per order.</td>
</tr>
<tr>
<td>valor</td>
<td>Numeric</td>
<td>Yes</td>
<td>1..12</td>
<td>Amount to be charged on the order (must be also included shipping costs, package, extras costs, boarding fees, etc). This amount will be charged from customer.</td>
</tr>
<tr>
<td>moeda</td>
<td>Numeric</td>
<td>Yes</td>
<td>3</td>
<td>Numeric code of currency at norm ISO 4217. For &ldquo;Real&rdquo;, the code is 986.</td>
</tr>
<tr>
<td>data-hora</td>
<td>Alphanumeric</td>
<td>Yes</td>
<td>19</td>
<td>Data hour of order. Format: yyyy-MM-ddTHH24:mm:ss</td>
</tr>
<tr>
<td>descricao</td>
<td>Alphanumeric</td>
<td>Optional</td>
<td>0..1024</td>
<td>Order description</td>
</tr>
<tr>
<td>idioma</td>
<td>Alphanumeric</td>
<td>Optional</td>
<td>2</td>
<td>Order language: PT (Portuguese), EN (English) or ES (Spanish). Based on this information the language is defined used on Cielo&rsquo; screens. If it won&rsquo;t be sent, the system will assume &ldquo;PT&rdquo;.</td>
</tr>
<tr>
<td>taxa-embarque</td>
<td>Numeric</td>
<td>Optional</td>
<td>1..9</td>
<td>Amount of authorization value that must be destined to boarding fee.</td>
</tr>
<tr>
<td>soft-descriptor</td>
<td>Alphanumeric</td>
<td>Optional</td>
<td>0..13</td>
<td>Text until 13 characters that will be shown on holder&rsquo;s invoice, after the Commercial Establishment name.</td>
</tr>
</tbody></table>

<aside class="notice">The customer register will be enable to transact only with REAL currency, in case you need more information, contact the service center, commercial manager or Cielo E-commerce Web Support.</aside>

<h3 id="forma-pagamento">forma-pagamento</h3>

<table><thead>
<tr>
<th>Element</th>
<th>Type</th>
<th>Mandatory</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>bandeira</td>
<td>Alphanumeric</td>
<td>Yes</td>
<td>n/a</td>
<td>NomeCard issuer&rsquo;s name (minuscule): &ldquo;visa&rdquo;, &ldquo;mastercard&rdquo;, &ldquo;diners&rdquo;, &ldquo;discover&rdquo;, &ldquo;elo&rdquo;, &ldquo;amex&rdquo;, &ldquo;jcb&rdquo;, &ldquo;aura&rdquo;.</td>
</tr>
<tr>
<td>produto</td>
<td>Alphanumeric</td>
<td>Yes</td>
<td>1</td>
<td>Product code: 1- Repayable on demand, 2- Credit card installments on store, A- Debt</td>
</tr>
<tr>
<td>parcelas</td>
<td>Numeric</td>
<td>Sim</td>
<td>1..2</td>
<td>Installments number. To repayable on demand or debt, use 1.</td>
</tr>
</tbody></table>

<aside class="warning">The result of order division by installments number don&rsquo;t must be lower than R$ 5,00. Otherwise the transaction will be deny.</aside>

<h2 id="integration-flux-and-redirection">Integration flux and redirection</h2>

<p>After creating a transaction, the browsing flux can be directed to Cielo environment, if the retailer requests the authentication on XML message.</p>

<p>In this situation, the retailer&rsquo; system will obtain the amount of TAG of XML returned to realize a redirection on customer browser and continues the process. The redirecting must be realized in &ldquo;Full Screen&rdquo; mode. In the other words, there is no more support to the pop up window. This way, from a checkout screen must be realized a redirecting to URL returned at transaction&rsquo;s creation.</p>

<aside class="notice">This redirection can be done through Http Redirect (as in the code Model) or through a Javascript.</aside>

<p>After the authentication process, the flux is returned to the retailer through the present information on TAG, sent in the first request to Cielo.</p>

<p>The diagram below makes easier the view of complete flux of browsing:</p>

<p><img alt="fluxo" src="images/fluxo.png" /></p>

<aside class="notice">Generally, the URL of return follow this format: https://minhaloja.com.br/pedido?id=12345678. This page must use the order number to internally search TID that was returned by Cielo. With this information, the page must realize a request of Consult via TID to Cielo&rsquo;s Web Service and interpret the result to show to customer.</aside>

<p>In the other hand, when there is no authentication, doesn&rsquo;t exist the context exchange or redirections and the integration is more simple:</p>

<p><img alt="fluxo-simples" src="images/fluxo-simples.png" /></p>

<h2 id="return-types">Return types</h2>

<p>There are three types of return that can be created on WebService response:</p>

<ol>
<li><code class="prettyprint">&lt;transacao&gt;</code></li>
<li><code class="prettyprint">&lt;retorno-token&gt;</code></li>
<li><code class="prettyprint">&lt;erro&gt;</code></li>
</ol>

<p>To operations related to a transaction (consults, authorization, capture and cancellation) in case of success the response is always a XML of type <code class="prettyprint">&lt;transacao&gt;</code>. In case of an exclusive request to create a token, the response expected is <code class="prettyprint">&lt;retorno-token&gt;</code>.</p>

<p>The next example shows the more reduced way of a message of return such <transaction>. Basically, it&rsquo;s composed by order data and data from transaction&rsquo;s configuration.</p>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;transacao</span> <span class="na">xmlns=</span><span class="s">"http://ecommerce.cbmp.com.br"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span> <span class="na">id=</span><span class="s">"6-e7762cbf8856"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;tid&gt;</span>10017348980735271001<span class="nt">&lt;/tid&gt;</span>
  <span class="nt">&lt;dados-pedido&gt;</span>
    <span class="nt">&lt;numero&gt;</span>1130006436<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;valor&gt;</span>1000<span class="nt">&lt;/valor&gt;</span>
    <span class="nt">&lt;moeda&gt;</span>986<span class="nt">&lt;/moeda&gt;</span>
    <span class="nt">&lt;data-hora&gt;</span>2011-12-05T16:01:28.655-02:00<span class="nt">&lt;/data-hora&gt;</span>
    <span class="nt">&lt;descricao&gt;</span>[origem:10.50.54.156]<span class="nt">&lt;/descricao&gt;</span>
    <span class="nt">&lt;idioma&gt;</span>PT<span class="nt">&lt;/idioma&gt;</span>
  <span class="nt">&lt;/dados-pedido&gt;</span>
  <span class="nt">&lt;forma-pagamento&gt;</span>
    <span class="nt">&lt;bandeira&gt;</span>visa<span class="nt">&lt;/bandeira&gt;</span>
    <span class="nt">&lt;produto&gt;</span>1<span class="nt">&lt;/produto&gt;</span>
    <span class="nt">&lt;parcelas&gt;</span>1<span class="nt">&lt;/parcelas&gt;</span>
  <span class="nt">&lt;/forma-pagamento&gt;</span>
  <span class="nt">&lt;status&gt;</span>0<span class="nt">&lt;/status&gt;</span>
  <span class="nt">&lt;url-autenticacao&gt;</span>https://ecommerce.cielo.com.br/web/index.cbmp?id=a783251<span class="nt">&lt;/url-autenticacao&gt;</span>
<span class="nt">&lt;/transacao&gt;</span>
</code></pre>

<p>The more important information are:</p>

<ul>
<li><strong>TID</strong>: it&rsquo;s the link between purchase order of online store and Cielo&rsquo;s transaction.</li>
<li><strong>URL de autenticação</strong>: indicates the page that starts the authentication (when requested).</li>
<li><strong>Status</strong>: it&rsquo;s the base information to store control the transaction.</li>
</ul>

<p>The table below details TAGS from basic-XML of return, identified by source node <code class="prettyprint">&lt;transacao&gt;</code>:</p>

<table><thead>
<tr>
<th>Element</th>
<th>Type</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>tid</td>
<td>Alphanumeric</td>
<td>1..40</td>
<td>Transaction identifier</td>
</tr>
<tr>
<td>dados-pedido</td>
<td></td>
<td></td>
<td>identical to source sent by store on the creation of transaction.</td>
</tr>
<tr>
<td>forma-pagamento</td>
<td></td>
<td></td>
<td>identical to source sent by store on creation of transaction.</td>
</tr>
<tr>
<td>status</td>
<td>Numeric</td>
<td>12</td>
<td>code of transaction. Look the appendix to a list of contacts.</td>
</tr>
<tr>
<td>url-autenticacao</td>
<td>Alphanumeric</td>
<td>1..256</td>
<td>URL of redirection to Cielo.</td>
</tr>
</tbody></table>

<p>Finally, there is another type of return which is employed every time a request can&rsquo;t be executed, because it&rsquo;s invalid or for some failure in its process. In this scenario, root node of XML response is like this <code class="prettyprint">&lt;erro&gt;</code>.</p>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;erro</span> <span class="na">xmlns=</span><span class="s">"http://ecommerce.cbmp.com.br"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;codigo&gt;</span>001<span class="nt">&lt;/codigo&gt;</span>
  <span class="nt">&lt;mensagem&gt;</span><span class="cp">&lt;![CDATA[O XML informado nao e valido:- string value '' does not match pattern for type of valor element in DadosPedido in namespace http://ecommerce.cbmp. com.br: '&lt;xml-fragment/&gt;]]&gt;</span>
  <span class="nt">&lt;/mensagem&gt;</span>
<span class="nt">&lt;/erro&gt;</span>
</code></pre>

<p>When the transaction is invalid, we can classify the error in two types:</p>

<ul>
<li><strong>Syntatic error</strong>: it happens when a XML message doesn&rsquo;t respect the rules defined by ecommerce.xsd archive. For example, a letter in numeric field, or an absence of a mandatory amount.</li>
<li><strong>Semantic error</strong>: it happens when a request asks an operation that is not supported for a specific transaction. For example, try to capture a transaction unauthorized, or even, cancel a transaction that is already cancelled.</li>
</ul>

<aside class="notice">The error messages always brings additional information that make easier the troubleshooting. The table in item &ldquo;Attachment - 6.2. Error catalog&rdquo; has a complete list with the error codes and its descriptions that must be considered to the integration development.</aside>

<h2 id="security-level-and-authentication">Security level and authentication</h2>

<p>Depending of card issuer, the transaction of Cielo E-commerce platform can be configured to be authenticated on card bank issuer (holder), in order to ensure the mayor level of security to the retailer.</p>

<p>The authentication isn&rsquo;t done automatically between systems, so it&rsquo;s necessary the customer interaction in the process, according the following explanation:</p>

<p>This happens always on the bank website (Internet Banking), using mechanisms and technologies independently from Cielo. In this way, it&rsquo;s possible for bank use an electronic token and password meanwhile another uses the password cards or CPF [c]to authenticate a transaction.</p>

<p>As shown previously, the mechanic of redirection is obtained through a tag <url-authentication> that is returned by Cielo on XML in the moment of a request of authorization to Web Service.</p>

<p>The authentication is mandatory for debt transactions and optional for credit. Nowadays only Visa and MasterCard support this functionality and consequently, only these two card issuers have the debt product.</p>

<aside class="notice">Consult products and card issuers supported on item 1.6. “Product and card issuers supported”.</aside>

<p>When there is authentication, the flux to execute an authorization happens in two steps, according to the diagram below:</p>

<p><img alt="fluxo-autenticacao" src="images/fluxo-autenticacao.png" /></p>

<ol>
<li>finishOrder() - it happens when a cardholder finishes the order and starts the payment purchase.

<ol>
<li>createTransaction (authenticated) - the retailer system send a XML request <requisicao-transacao> requesting an authenticated transaction, in other words, a TAG will be 0,1 or 2. After this, Cielo will inform at XML returned a field with the address which the holder must be redirected for.</li>
</ol></li>
<li>access (url-authentication) - the holder&rsquo;s browser is redirected to Cielo environment. Thereby, the Cielo&rsquo;s page is accessed, it automatically is directed to an issuer bank (3.1). This redirect is so fast that is practically imperceptible.</li>
<li>authenticate (token, cpf) - the holder will be on bank environment and will use some mechanism provided by his/her own issuer to realize the authentication of the transaction (generally token, &ldquo;bingo card&rdquo;/security card, cpf, electronic sign, etc).

<ol>
<li>resultAuthentication ()- the issuer bank redirects the flux to Cielo with the result of authentication. Then, the flux backs to normal, according to item &ldquo;2.3 Architecture of integration&rdquo;. 1. process () - Cielo system process the return of authentication and submit to authorization and, optionally, to automatic capture.</li>
<li>sendRedirect(url-return) - Cielo system send a redirection to customer browser to the address specificated on URL of return, provided on the first request (<requisicao-transacao>)

<ol>
<li>access (url-return) - the holder&rsquo;s browser access the URL on store environment, where we recommend that you have a consult request via TID to Cielo Web Service.</li>
</ol></li>
</ol></li>
</ol>

<h3 id="notes">Notes</h3>

<ul>
<li>Only on first redirection (1.2: send Redirect()) is Online Store responsability.</li>
<li>The buyer is redirected on bank issuer only if the authentication is available. Otherwise, the transaction will progress to authorization automatically (excepting if the authentication has been just requested).</li>
</ul>

<aside class="notice">Consult products and card issuers supported on item 1.6. “Product and card issuers supported”.</aside>

<p>Os pré-requisitos para que uma transação seja autenticada estão relacionados abaixo:</p>

<ul>
<li>Banco e Bandeira devem ser participantes do programa de autenticação;</li>
<li>O BIN do cartão deve ser participante do programa de autenticação;</li>
<li>A configuração da <requisicao-transacao>//<autorizar> deve ser 0, 1 ou 2.</li>
</ul>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;transacao</span> <span class="na">xmlns=</span><span class="s">"http://ecommerce.cbmp.com.br"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span> <span class="na">id=</span><span class="s">"add7d51e-f7a1-41b1-b224-4ffbd724730c"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;tid&gt;</span>1001734898073E931001<span class="nt">&lt;/tid&gt;</span>
  <span class="nt">&lt;pan&gt;</span>IqVz7P9zaIgTYdU41HaW/OB/d7Idwttqwb2vaTt8MT0=<span class="nt">&lt;/pan&gt;</span>
  <span class="nt">&lt;dados-pedido&gt;</span>
    <span class="nt">&lt;numero&gt;</span>1196683550<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;valor&gt;</span>1000<span class="nt">&lt;/valor&gt;</span>
    <span class="nt">&lt;moeda&gt;</span>986<span class="nt">&lt;/moeda&gt;</span>
    <span class="nt">&lt;data-hora&gt;</span>2011-12-08T10:44:24.244-02:00<span class="nt">&lt;/data-hora&gt;</span>
    <span class="nt">&lt;descricao&gt;</span>[origem:10.50.54.156]<span class="nt">&lt;/descricao&gt;</span>
    <span class="nt">&lt;idioma&gt;</span>PT<span class="nt">&lt;/idioma&gt;</span>
    <span class="nt">&lt;taxa-embarque&gt;</span>1000<span class="nt">&lt;/taxa-embarque&gt;</span>
  <span class="nt">&lt;/dados-pedido&gt;</span>
  <span class="nt">&lt;forma-pagamento&gt;</span>
    <span class="nt">&lt;bandeira&gt;</span>visa<span class="nt">&lt;/bandeira&gt;</span>
    <span class="nt">&lt;produto&gt;</span>1<span class="nt">&lt;/produto&gt;</span>
    <span class="nt">&lt;parcelas&gt;</span>1<span class="nt">&lt;/parcelas&gt;</span>
  <span class="nt">&lt;/forma-pagamento&gt;</span>
  <span class="nt">&lt;status&gt;</span>2<span class="nt">&lt;/status&gt;</span>
  <span class="nt">&lt;autenticacao&gt;</span>
    <span class="nt">&lt;codigo&gt;</span>2<span class="nt">&lt;/codigo&gt;</span>
    <span class="nt">&lt;mensagem&gt;</span>Autenticada com sucesso<span class="nt">&lt;/mensagem&gt;</span>
    <span class="nt">&lt;data-hora&gt;</span>2011-12-08T10:44:47.311-02:00<span class="nt">&lt;/data-hora&gt;</span>
    <span class="nt">&lt;valor&gt;</span>1000<span class="nt">&lt;/valor&gt;</span>
    <span class="nt">&lt;eci&gt;</span>5<span class="nt">&lt;/eci&gt;</span>
  <span class="nt">&lt;/autenticacao&gt;</span>
<span class="nt">&lt;/transacao&gt;</span>
</code></pre>

<p>Just the &ldquo;node&rdquo; fields <code class="prettyprint">&lt;autenticacao&gt;</code> are listed on the table below:</p>

<table><thead>
<tr>
<th>Elemento</th>
<th>Tipo</th>
<th>Tamanho</th>
<th>Descrição</th>
</tr>
</thead><tbody>
<tr>
<td>codigo</td>
<td>Numérico</td>
<td>1.2</td>
<td>Código do processamento</td>
</tr>
<tr>
<td>mensagem</td>
<td>Alfanumérico</td>
<td>1..100</td>
<td>Detalhe do processamento</td>
</tr>
<tr>
<td>data-hora</td>
<td>Alfanumérico</td>
<td>19</td>
<td>Data e hora do processamento</td>
</tr>
<tr>
<td>valor</td>
<td>Numérico</td>
<td>1..12</td>
<td>Valor do processamento sem pontuação. Os dois últimos dígitos são os centavos.</td>
</tr>
<tr>
<td>eci</td>
<td>Numérico</td>
<td>2</td>
<td>Nível de segurança.</td>
</tr>
</tbody></table>

<p>The ECI field (Eletronic Commerce Indicator) represents how safety is a transaction. This amount must be considered for the retailer to decide about transaction capture.</p>

<aside class="warning">The ECI indicator is very important, because it&rsquo;s what defines the Chargeback&rsquo;s rules.</aside>

<h1 id="operations-and-configurations">Operations and configurations</h1>

<h2 id="creating-an-authorization-of-transaction">Creating an authorization of transaction</h2>

<p>The request for an authorization is the main operation of Cielo E-commerce, because it&rsquo;s through that a sale can be concreted and the sale process can be finished. The authorization has a sequence of configuration that can be customized, besides the functionalities that have value to customer and retailers.</p>

<h2 id="direct-authorization">Direct authorization</h2>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;requisicao-transacao</span> <span class="na">id=</span><span class="s">"a97ab62a-7956-41ea-b03f-c2e9f612c293"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;dados-ec&gt;</span>
    <span class="nt">&lt;numero&gt;</span>1006993069<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;chave&gt;</span>25fbb997438630f30b112d033ce2e621b34f3<span class="nt">&lt;/chave&gt;</span>
  <span class="nt">&lt;/dados-ec&gt;</span>
  <span class="nt">&lt;dados-portador&gt;</span>
    <span class="nt">&lt;numero&gt;</span>4012001038443335<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;validade&gt;</span>201508<span class="nt">&lt;/validade&gt;</span>
    <span class="nt">&lt;indicador&gt;</span>1<span class="nt">&lt;/indicador&gt;</span>
    <span class="nt">&lt;codigo-seguranca&gt;</span>973<span class="nt">&lt;/codigo-seguranca&gt;</span>
  <span class="nt">&lt;/dados-portador&gt;</span>
  <span class="nt">&lt;dados-pedido&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;/dados-pedido&gt;</span>
  <span class="nt">&lt;forma-pagamento&gt;</span>
    <span class="nt">&lt;bandeira&gt;</span>visa<span class="nt">&lt;/bandeira&gt;</span>
    <span class="nt">&lt;produto&gt;</span>1<span class="nt">&lt;/produto&gt;</span>
    <span class="nt">&lt;parcelas&gt;</span>1<span class="nt">&lt;/parcelas&gt;</span>
  <span class="nt">&lt;/forma-pagamento&gt;</span>
  <span class="nt">&lt;url-retorno&gt;</span>http://localhost/lojaexemplo/retorno.jsp<span class="nt">&lt;/url-retorno&gt;</span>
  <span class="nt">&lt;autorizar&gt;</span>3<span class="nt">&lt;/autorizar&gt;</span>
  <span class="nt">&lt;capturar&gt;</span>false<span class="nt">&lt;/capturar&gt;</span>
<span class="nt">&lt;/requisicao-transacao&gt;</span>
</code></pre>

<p>The direct authorization is characterized for being a transaction without authentication from holder, because it&rsquo;s a retailer option (and risk), or because the card issuer or emitter don&rsquo;t have support. The direct authorization can be done in two ways: traditional (with card data) or using a token.</p>

<h3 id="traditional">Traditional</h3>

<ul>
<li><p><strong>Purpose</strong> - Submit a direct transaction using a credit card.</p></li>
<li><p><strong>Objetivo</strong> - Submeter uma transação direta com o uso de um cartão de crédito.</p></li>
<li><p><strong>Rules</strong></p>

<ul>
<li>The online store register must be enable to send card data.</li>
<li>Send a TAG <authorize> with the value &ldquo;3&rdquo;.</li>
<li>Valid only for credit.</li>
<li>The retailer must pay attention on sending card rules.</li>
<li>In direct authorization, the security level of transaction (ECI) is defined as:

<ul>
<li>&ldquo;7&rdquo;  for Visa, Mastercard and Aura</li>
<li>&ldquo;0&rdquo; for Mastercard and Aura</li>
</ul></li>
</ul></li>
</ul>

<h2 id="recurrent-authorization">Recurrent authorization</h2>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;requisicao-transacao</span> <span class="na">id=</span><span class="s">"a97ab62a-7956-41ea-b03f-c2e9f612c293"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;dados-ec&gt;</span>
    <span class="nt">&lt;numero&gt;</span>1006993069<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;chave&gt;</span>25fbb997438630f30b112d033ce2e621b34f3<span class="nt">&lt;/chave&gt;</span>
  <span class="nt">&lt;/dados-ec&gt;</span>
  <span class="nt">&lt;dados-portador&gt;</span>
    <span class="nt">&lt;numero&gt;</span>4012001038443335<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;validade&gt;</span>201508<span class="nt">&lt;/validade&gt;</span>
    <span class="nt">&lt;indicador&gt;</span>1<span class="nt">&lt;/indicador&gt;</span>
    <span class="nt">&lt;codigo-seguranca&gt;</span>973<span class="nt">&lt;/codigo-seguranca&gt;</span>
  <span class="nt">&lt;/dados-portador&gt;</span>
  <span class="nt">&lt;dados-pedido&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;/dados-pedido&gt;</span>
  <span class="nt">&lt;forma-pagamento&gt;</span>
    <span class="nt">&lt;bandeira&gt;</span>visa<span class="nt">&lt;/bandeira&gt;</span>
    <span class="nt">&lt;produto&gt;</span>1<span class="nt">&lt;/produto&gt;</span>
    <span class="nt">&lt;parcelas&gt;</span>1<span class="nt">&lt;/parcelas&gt;</span>
  <span class="nt">&lt;/forma-pagamento&gt;</span>
  <span class="nt">&lt;url-retorno&gt;</span>http://localhost/lojaexemplo/retorno.jsp<span class="nt">&lt;/url-retorno&gt;</span>
  <span class="nt">&lt;autorizar&gt;</span>4<span class="nt">&lt;/autorizar&gt;</span>
  <span class="nt">&lt;capturar&gt;</span>false<span class="nt">&lt;/capturar&gt;</span>
<span class="nt">&lt;/requisicao-transacao&gt;</span>
</code></pre>

<p>The recurrent authorization must be done in two ways: sending a token previously registered, or using a card. The recurrent transaction is very similar than traditional transaction, the changes consist on the rules that emitter and card issuer use to authorize or deny a transaction. Another difference is related to &ldquo;Renova Fácil&rdquo; (Easy Renew).</p>

<aside class="notice">To know if your store is eligible to use a recurrent authorization, check with our service center or Cielo E-commerce Web Support.</aside>

<h3 id="recurrent-authorization-with-card">Recurrent authorization with card</h3>

<ul>
<li><strong>Purpose</strong> - Submit a recurrent transaction using a credit card.** - Submeter uma transação recorrente com o uso de um cartão de crédito.</li>
<li><strong>Rules</strong>

<ul>
<li>Send a TAG <autorizar> with value &ldquo;4&rdquo;.</li>
<li>Valid just for lump sum.</li>
</ul></li>
</ul>

<h3 id="easy-renew-(renova-fácil):">EASY RENEW (Renova Fácil):</h3>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;transacao</span> <span class="na">xmlns=</span><span class="s">"http://ecommerce.cbmp.com.br"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span> <span class="na">id=</span><span class="s">"d35b67189442"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;tid&gt;</span>10069930690362461001<span class="nt">&lt;/tid&gt;</span>
  <span class="nt">&lt;pan&gt;</span>uv9yI5tkhX9jpuCt+dfrtoSVM4U3gIjvrcwMBfZcadE=<span class="nt">&lt;/pan&gt;</span>
  <span class="nt">&lt;dados-pedido&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;/dados-pedido&gt;</span>
  <span class="nt">&lt;forma-pagamento&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;/forma-pagamento&gt;</span>
  <span class="nt">&lt;status&gt;</span>5<span class="nt">&lt;/status&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;autorizacao&gt;</span>
    <span class="nt">&lt;codigo&gt;</span>5<span class="nt">&lt;/codigo&gt;</span>
    <span class="nt">&lt;mensagem&gt;</span>Autorização negada<span class="nt">&lt;/mensagem&gt;</span>
    <span class="nt">&lt;data-hora&gt;</span>2011-12-09T10:58:45.847-02:00<span class="nt">&lt;/data-hora&gt;</span>
    <span class="nt">&lt;valor&gt;</span>1000<span class="nt">&lt;/valor&gt;</span>
    <span class="nt">&lt;lr&gt;</span>57<span class="nt">&lt;/lr&gt;</span>
    <span class="nt">&lt;nsu&gt;</span>221766<span class="nt">&lt;/nsu&gt;</span>
  <span class="nt">&lt;/autorizacao&gt;</span>
  <span class="nt">&lt;dados-portador&gt;</span>
    <span class="nt">&lt;numero&gt;</span>4012001038443335<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;validade&gt;</span>201508<span class="nt">&lt;/validade&gt;</span>
    <span class="nt">&lt;codigo-seguranca/&gt;</span>
  <span class="nt">&lt;/dados-portador&gt;</span>
<span class="nt">&lt;/transacao&gt;</span>
</code></pre>

<p>This functionality makes easier to identify a card which has been replaced for another at emitter bank. In this way, when a recurrent transaction is submitted to Web Service and Cielo identifies that the card used is outdated, the system will behave like that:</p>

<ol>
<li>If the recurrent transaction has been send through a card, the authorization will be denied and it will returned the data of new card, according to the diagram below:</li>
</ol>

<p><img alt="remova fácil" src="images/remova-facil.png" /></p>

<aside class="notice">The &ldquo;Renova Fácil&rdquo; (Easy Renew) is only available on recurrent transactions. The Easy Renew effectiveness depends of correct usage of recurrent transactions properly signalized. Consult banks and card issuers participants with Cielo E-commerce Web Support.</aside>

<h3 id="authorization-of-a-transaction-previously-created">Authorization of a transaction previously created</h3>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;requisicao-autorizacao-tid</span> <span class="na">id=</span><span class="s">"0000000000"</span> <span class="na">versao=</span><span class="s">"1.2.0"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;tid&gt;</span>1006993069990BCAA001<span class="nt">&lt;/tid&gt;</span>
  <span class="nt">&lt;dados-ec&gt;</span>
    <span class="nt">&lt;numero&gt;</span>1006993069<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;chave&gt;</span>25fbb997438630f30b112d033ce2e621b34f3<span class="nt">&lt;/chave&gt;</span>
  <span class="nt">&lt;/dados-ec&gt;</span>
<span class="nt">&lt;/requisicao-autorizacao-tid&gt;</span>
</code></pre>

<p>To the establishments that use the authentication process of authentication it&rsquo;s possible to request an authorization of transaction that stopped after the execution of this process. The message to perform this operation is &ldquo;requisicao-autorizacao-tid&rdquo;, as described below:</p>

<aside class="notice">Requests to transactions that weren&rsquo;t submit to the authentication process or have been interrupted, because the holder made a mistake on the password won&rsquo;t be accepted.</aside>

<table><thead>
<tr>
<th>Element</th>
<th>Type</th>
<th>Mandatory</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>tid</td>
<td>Alphanumeric</td>
<td>Yes</td>
<td>20</td>
<td>transaction identifier</td>
</tr>
<tr>
<td>dados-ec.numero</td>
<td>Numeric</td>
<td>Yes</td>
<td>1..20</td>
<td>affiliation store number with Cielo.</td>
</tr>
<tr>
<td>dados-ec.chave</td>
<td>Alphanumeric</td>
<td>Yes</td>
<td>1..100</td>
<td>store access key attributed by Cielo.</td>
</tr>
</tbody></table>

<h2 id="transaction-with-token">Transaction with token</h2>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;requisicao-token</span> <span class="na">id=</span><span class="s">"8fc889c7-004f-42f1-963a-31aa26f75e5c"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;dados-ec&gt;</span>
    <span class="nt">&lt;numero&gt;</span>1006993069<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;chave&gt;</span>25fbb99741c739dd84d7b06ec78c9bac718838630f30b112d033ce2e621b34f3<span class="nt">&lt;/chave&gt;</span>
  <span class="nt">&lt;/dados-ec&gt;</span>
  <span class="nt">&lt;dados-portador&gt;</span>
    <span class="nt">&lt;numero&gt;</span>4012001038443335<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;validade&gt;</span>201508<span class="nt">&lt;/validade&gt;</span>
    <span class="nt">&lt;nome-portador&gt;</span>FULANO DA SILVA<span class="nt">&lt;/nome-portador&gt;</span>
  <span class="nt">&lt;/dados-portador&gt;</span>
<span class="nt">&lt;/requisicao-token&gt;</span>
</code></pre>

<ul>
<li><strong>Purpose</strong> - Request the creation of a token associated to a credit card to help the transaction sending without card.</li>
<li><strong>Rules</strong>

<ul>
<li>The Token is unique to a specific [Card+Commercial Establishment]. So, a card can be &ldquo;tokenized&rdquo; in more than a store and each one will has different codes.</li>
<li>If more than one request has been sent with the same data, the token returned will be always the same.</li>
<li>The creation of token is independent of a transaction result (approved/denied).</li>
</ul></li>
</ul>

<aside class="warning">Transactions via token don&rsquo;t dispense the retailer from sending card issuer information, however is necessary that retailer system (or gateway) that will hold tokens also hold card issuers that have been tokenized.</aside>

<aside class="notice">A token that is not used for more than a year will be automatically removed from Cielo data banking. It&rsquo;s possible to block a specific token to don’t be more used. The block of token must be requested to Cielo E-commerce Web Support.</aside>

<table><thead>
<tr>
<th>Element</th>
<th>Type</th>
<th>Mandatory</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dados-ec.numero</td>
<td>Numérico</td>
<td>Sim</td>
<td>1..20</td>
<td>Store affiliation number with Cielo</td>
</tr>
<tr>
<td>dados-ec.chave</td>
<td>Alfanumérico</td>
<td>Sim</td>
<td>1..100</td>
<td>Store access key assigned by Cielo.</td>
</tr>
<tr>
<td>daods-portador</td>
<td>n/a</td>
<td>Opcional</td>
<td>n/a</td>
<td>Node with card data</td>
</tr>
<tr>
<td>dados-portador.numero</td>
<td>Numérico</td>
<td>Sim</td>
<td>19</td>
<td>Card number</td>
</tr>
<tr>
<td>dados-portador.validade</td>
<td>Numérico</td>
<td>Sim</td>
<td>6</td>
<td>Card validity on yyyymm format. Example: 201212 (dec/2012)</td>
</tr>
<tr>
<td>dados-portador.nome-portador</td>
<td>Alfanumérico</td>
<td>Opcional</td>
<td>0..50</td>
<td>Name printed as in the card</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;retorno-token</span> <span class="na">xmlns=</span><span class="s">"http://ecommerce.cbmp.com.br"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span> <span class="na">id=</span><span class="s">"57239017"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;token&gt;</span>
    <span class="nt">&lt;dados-token&gt;</span>
      <span class="nt">&lt;codigo-token&gt;</span>TuS6LeBHWjqFFtE7S3zR052Jl/KUlD+tYJFpAdlA87E=<span class="nt">&lt;/codigo-token&gt;</span>
      <span class="nt">&lt;status&gt;</span>1<span class="nt">&lt;/status&gt;</span>
      <span class="nt">&lt;numero-cartao-truncado&gt;</span>455187******0183<span class="nt">&lt;/numero-cartao-truncado&gt;</span>
    <span class="nt">&lt;/dados-token&gt;</span>
  <span class="nt">&lt;/token&gt;</span>
<span class="nt">&lt;/retorno-token&gt;</span>
</code></pre>

<p>The return will be such as when a request has been concluded with success, or in case of failure.</p>

<table><thead>
<tr>
<th>Element</th>
<th>Type</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>codigo-token</td>
<td>Alfanumérico</td>
<td>100</td>
<td>Code of token created</td>
</tr>
<tr>
<td>status</td>
<td>Numérico</td>
<td>1</td>
<td>Status do Token: 0 – Bloqueado, 1 – Desbloqueado</td>
</tr>
<tr>
<td>numero-cartao-truncado</td>
<td>Alfanumérico</td>
<td>1..16</td>
<td>truncated-card-number</td>
</tr>
</tbody></table>

<h3 id="direct-authorization-via-token">Direct Authorization via TOKEN</h3>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;requisicao-transacao</span> <span class="na">id=</span><span class="s">"a97ab62a-7956-41ea-b03f-c2e9f612c293"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;dados-ec&gt;</span>
    <span class="nt">&lt;numero&gt;</span>1006993069<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;chave&gt;</span>25fbb997438630f30b112d033ce2e621b34f3<span class="nt">&lt;/chave&gt;</span>
  <span class="nt">&lt;/dados-ec&gt;</span>
  <span class="nt">&lt;dados-portador&gt;</span>
    <span class="nt">&lt;token&gt;</span>TuS6LeBHWjqFFtE7S3zR052Jl/KUlD+tYJFpAdlA87E=<span class="nt">&lt;/token&gt;</span>
  <span class="nt">&lt;/dados-portador&gt;</span>
  <span class="nt">&lt;dados-pedido&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;/dados-pedido&gt;</span>
  <span class="nt">&lt;forma-pagamento&gt;</span>
    <span class="nt">&lt;bandeira&gt;</span>visa<span class="nt">&lt;/bandeira&gt;</span>
    <span class="nt">&lt;produto&gt;</span>1<span class="nt">&lt;/produto&gt;</span>
    <span class="nt">&lt;parcelas&gt;</span>1<span class="nt">&lt;/parcelas&gt;</span>
  <span class="nt">&lt;/forma-pagamento&gt;</span>
  <span class="nt">&lt;url-retorno&gt;</span>http://localhost/lojaexemplo/retorno.jsp<span class="nt">&lt;/url-retorno&gt;</span>
  <span class="nt">&lt;autorizar&gt;</span>3<span class="nt">&lt;/autorizar&gt;</span>
  <span class="nt">&lt;capturar&gt;</span>true<span class="nt">&lt;/capturar&gt;</span>
<span class="nt">&lt;/requisicao-transacao&gt;</span>
</code></pre>

<ul>
<li><strong>Purpose</strong> - To submit a direct transaction (without authentication) using a token previously registered.</li>
<li><strong>Rules</strong>

<ul>
<li>To send a TAG <autorizar> with the value &ldquo;3&rdquo;.</li>
<li>Token must be unlocked</li>
<li>Valid just for credit.</li>
</ul></li>
</ul>

<h3 id="recurrent-authorization-with-token">Recurrent Authorization with TOKEN</h3>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;requisicao-transacao</span> <span class="na">id=</span><span class="s">"a97ab62a-7956-41ea-b03f-c2e9f612c293"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;dados-ec&gt;</span>
    <span class="nt">&lt;numero&gt;</span>1006993069<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;chave&gt;</span>25fbb997438630f30b112d033ce2e621b34f3<span class="nt">&lt;/chave&gt;</span>
  <span class="nt">&lt;/dados-ec&gt;</span>
  <span class="nt">&lt;dados-portador&gt;</span>
    <span class="nt">&lt;token&gt;</span>TuS6LeBHWjqFFtE7S3zR052Jl/KUlD+tYJFpAdlA87E=<span class="nt">&lt;/token&gt;</span>
  <span class="nt">&lt;/dados-portador&gt;</span>
  <span class="nt">&lt;dados-pedido&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;/dados-pedido&gt;</span>
  <span class="nt">&lt;forma-pagamento&gt;</span>
    <span class="nt">&lt;bandeira&gt;</span>visa<span class="nt">&lt;/bandeira&gt;</span>
    <span class="nt">&lt;produto&gt;</span>1<span class="nt">&lt;/produto&gt;</span>
    <span class="nt">&lt;parcelas&gt;</span>1<span class="nt">&lt;/parcelas&gt;</span>
  <span class="nt">&lt;/forma-pagamento&gt;</span>
  <span class="nt">&lt;url-retorno&gt;</span>http://localhost/lojaexemplo/retorno.jsp<span class="nt">&lt;/url-retorno&gt;</span>
  <span class="nt">&lt;autorizar&gt;</span>4<span class="nt">&lt;/autorizar&gt;</span>
  <span class="nt">&lt;capturar&gt;</span>true<span class="nt">&lt;/capturar&gt;</span>
<span class="nt">&lt;/requisicao-transacao&gt;</span>

</code></pre>

<ul>
<li><strong>Purpose</strong> - To submit a recurrent transaction using a token previously registered.** - Submeter uma transação recorrente com o uso de um token previamente cadastrado.</li>
<li><strong>Rules</strong>

<ul>
<li>To send a TAG <autorizar> with the value &ldquo;4&rdquo;.</li>
<li>Token must be unlocked.</li>
<li>Valid just for lump sum.</li>
</ul></li>
</ul>

<h3 id="easy-renew-with-token">Easy Renew with TOKEN</h3>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;transacao</span> <span class="na">xmlns=</span><span class="s">"http://ecommerce.cbmp.com.br"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span> <span class="na">id=</span><span class="s">"d35b67189442"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;tid&gt;</span>10069930690362461001<span class="nt">&lt;/tid&gt;</span>
  <span class="nt">&lt;pan&gt;</span>uv9yI5tkhX9jpuCt+dfrtoSVM4U3gIjvrcwMBfZcadE=<span class="nt">&lt;/pan&gt;</span>
  <span class="nt">&lt;dados-pedido&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;/dados-pedido&gt;</span>
  <span class="nt">&lt;forma-pagamento&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;/forma-pagamento&gt;</span>
  <span class="nt">&lt;status&gt;</span>5<span class="nt">&lt;/status&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;autorizacao&gt;</span>
    <span class="nt">&lt;codigo&gt;</span>5<span class="nt">&lt;/codigo&gt;</span>
    <span class="nt">&lt;mensagem&gt;</span>Autorização negada<span class="nt">&lt;/mensagem&gt;</span>
    <span class="nt">&lt;data-hora&gt;</span>2011-12-09T10:58:45.847-02:00<span class="nt">&lt;/data-hora&gt;</span>
    <span class="nt">&lt;valor&gt;</span>1000<span class="nt">&lt;/valor&gt;</span>
    <span class="nt">&lt;lr&gt;</span>57<span class="nt">&lt;/lr&gt;</span>
    <span class="nt">&lt;nsu&gt;</span>221766<span class="nt">&lt;/nsu&gt;</span>
  <span class="nt">&lt;/autorizacao&gt;</span>
  <span class="nt">&lt;token&gt;</span>
    <span class="nt">&lt;dados-token&gt;</span>
      <span class="nt">&lt;codigo-token&gt;</span>TuS6LeBHWjqFFtE7S3zR052Jl/KUlD+tYJFpAdlA87E=<span class="nt">&lt;/codigo-token&gt;</span>
      <span class="nt">&lt;status&gt;</span>1<span class="nt">&lt;/status&gt;</span>
      <span class="nt">&lt;numero-cartao-truncado&gt;</span>455187******0183<span class="nt">&lt;/numero-cartao-truncado&gt;</span>
    <span class="nt">&lt;/dados-token&gt;</span>
  <span class="nt">&lt;/token&gt;</span>
<span class="nt">&lt;/transacao&gt;</span>
</code></pre>

<p>This functionality makes easier to identify a card which has been replaced for another in emitter bank. So, when a recurrent transaction is submitted to Web Service and Cielo identifies a card in use outdated, the system will behave like that:</p>

<ol>
<li>In case of recurrent transaction had been sent through a token, the authorization will denied and a new token will return to be used, according to the diagram below:</li>
</ol>

<p><img alt="remova fácil com token" src="images/remova-facil-token.png" /></p>

<h3 id="creating-token">Creating TOKEN</h3>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;requisicao-transacao</span> <span class="na">id=</span><span class="s">"a97ab62a-7956-41ea-b03f-c2e9f612c293"</span> <span class="na">versao=</span><span class="s">"1.2.0"</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;gerar-token&gt;</span>true<span class="nt">&lt;/gerar-token&gt;</span>
<span class="nt">&lt;/requisicao-transacao&gt;</span>
</code></pre>

<aside class="warning">This additional service is subjected to a charge from the moment of a token create request.</aside>

<ul>
<li><strong>Purpose</strong> - Beyond the specific message to creation of a token, described in a transaction with token, it&rsquo;s possible to employ an authorization request to ask a creation of token, adding the information <gerar-token> in the node of request of a transaction.</li>
<li><strong>Rules</strong>

<ul>
<li>In case of a card being submitted more than once for the same retailer, the Token created will be the same.</li>
</ul></li>
</ul>

<h2 id="aggregated-functionality">Aggregated functionality</h2>

<h3 id="authentication-and-transaction-with-debit-card">Authentication and transaction with debit card</h3>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;requisicao-transacao</span> <span class="na">id=</span><span class="s">"a97ab62a-7956-41ea-b03f-c2e9f612c293"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;forma-pagamento&gt;</span>
    <span class="nt">&lt;bandeira&gt;</span>visa<span class="nt">&lt;/bandeira&gt;</span>
    <span class="nt">&lt;produto&gt;</span>A<span class="nt">&lt;/produto&gt;</span>
    <span class="nt">&lt;parcelas&gt;</span>1<span class="nt">&lt;/parcelas&gt;</span>
  <span class="nt">&lt;/forma-pagamento&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;autorizar&gt;</span>1<span class="nt">&lt;/autorizar&gt;</span>
<span class="nt">&lt;/requisicao-transacao&gt;</span>
</code></pre>

<p>The authenticated transaction will ensure an extra security for the retailer against Chargebacks, however, according to presented on chapter &ldquo;2.5 - Authentication and security level&rdquo;, neither all card issuers and emitters make this kind of service available.</p>

<p>The debit product mandatorily requires an authenticated transaction, otherwise, the transaction won&rsquo;t be authorized.</p>

<ul>
<li><strong>Purpose</strong> - Make eligible the transaction for authentication.</li>
<li><strong>Rules</strong>

<ul>
<li>To send a flag <code class="prettyprint">autorizar</code> according to the domain below, to try:</li>
<li>0 - Only authenticate a transaction</li>
<li>1- Submit to authorization only if the transaction be authenticated.</li>
<li>2- Submit to authorization if the transaction be authenticated or not.</li>
<li>For debit, send the product &ldquo;A&rdquo; at XML.</li>
<li>The request to authorization of a transaction that has been just authenticated can be done in until 90 days after the initial date.</li>
</ul></li>
</ul>

<aside class="notice">Considering that the authentication doesn&rsquo;t depend exclusively of this flag, we recommend that you always verify the field to check the result of authentication.</aside>

<h3 id="soft-descriptor">Soft Descriptor</h3>
<pre><code class="highlight xml"><span class="nt">&lt;requisicao-transacao</span> <span class="na">id=</span><span class="s">"a97ab62a-7956-41ea-b03f-c2e9f612c293"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;dados-pedido&gt;</span>
    <span class="nt">&lt;numero&gt;</span>178148599<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;valor&gt;</span>1000<span class="nt">&lt;/valor&gt;</span>
    <span class="nt">&lt;moeda&gt;</span>986<span class="nt">&lt;/moeda&gt;</span>
    <span class="nt">&lt;data-hora&gt;</span>2011-12-07T11:43:37<span class="nt">&lt;/data-hora&gt;</span>
    <span class="nt">&lt;descricao&gt;</span>[origem:10.50.54.156]<span class="nt">&lt;/descricao&gt;</span>
    <span class="nt">&lt;idioma&gt;</span>PT<span class="nt">&lt;/idioma&gt;</span>
    <span class="nt">&lt;soft-descriptor&gt;</span>soft-descriptor<span class="nt">&lt;/soft-descriptor&gt;</span>
  <span class="nt">&lt;/dados-pedido&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;/requisicao-transacao&gt;</span>
</code></pre>

<ul>
<li><strong>Purpose</strong> - Allows the retailer to send a text with until 13 characters that will be printed on holder invoice, next to store identification, respecting the card issuers length:

<ul>
<li><strong>Visa</strong>: 25 characters</li>
<li><strong>Mastercard</strong>: 11 characters</li>
</ul></li>
<li><strong>Rules</strong>

<ul>
<li>Maximum size: 13 characters</li>
<li>Available only for Visa and Mastercard issuers.</li>
<li>Exclusive use of simple characters.</li>
</ul></li>
</ul>

<aside class="notice">To know and/or change the name of store that will be printed on holder&rsquo;s invoice, please, contact our service center.</aside>

<h3 id="automatic-capture">Automatic Capture</h3>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;requisicao-transacao</span> <span class="na">id=</span><span class="s">"a97ab62a-7956-41ea-b03f-c2e9f612c293"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;capturar&gt;</span>true<span class="nt">&lt;/capturar&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;/requisicao-transacao&gt;</span>
</code></pre>

<ul>
<li><strong>Purpose</strong> - The automatic capture allows a request of authorization to be captured immediately after its approval. So it&rsquo;s not necessary realize a <code class="prettyprint">&lt;requisicao-captura&gt;</code>.</li>
<li><strong>Rules</strong>

<ul>
<li>Just approved authorizations can be captured automatically.</li>
</ul></li>
</ul>

<h3 id="boarding-fee">Boarding fee</h3>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;requisicao-transacao</span> <span class="na">id=</span><span class="s">"a97ab62a-7956-41ea-b03f-c2e9f612c293"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;dados-pedido&gt;</span>
    <span class="nt">&lt;numero&gt;</span>178148599<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;valor&gt;</span>10000<span class="nt">&lt;/valor&gt;</span>
    <span class="nt">&lt;moeda&gt;</span>986<span class="nt">&lt;/moeda&gt;</span>
    <span class="nt">&lt;data-hora&gt;</span>2011-12-07T11:43:37<span class="nt">&lt;/data-hora&gt;</span>
    <span class="nt">&lt;descricao&gt;</span>[origem:10.50.54.156]<span class="nt">&lt;/descricao&gt;</span>
    <span class="nt">&lt;idioma&gt;</span>PT<span class="nt">&lt;/idioma&gt;</span>
    <span class="nt">&lt;soft-descriptor&gt;</span>softdescriptor<span class="nt">&lt;/soft-descriptor&gt;</span>
    <span class="nt">&lt;taxa-embarque&gt;</span>1000<span class="nt">&lt;/taxa-embarque&gt;</span>
  <span class="nt">&lt;/dados-pedido&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;/requisicao-transacao&gt;</span>
</code></pre>

<ul>
<li><strong>Purpose</strong>: the boarding fee is the informative field that defines the total amount of transaction  (informed on tag data-order//value) that must be destined to payment of Infraero tax.

<ul>
<li>The boarding fee is not accumulated to authorization value. For example, in a airplane ticket sale of R$ 200,00 with boarding fee of R$ 25,00 you have to send the field <code class="prettyprint">&lt;valor&gt;22500&lt;/valor&gt;</code> and <code class="prettyprint">&lt;taxa-embarque&gt;2500&lt;/taxa-embarque&gt;</code>.</li>
</ul></li>
<li><strong>Rules</strong>

<ul>
<li>Available just for Visa and Mastercard issuers.</li>
<li>The boarding fee is not added to authorization value, in other words, it&rsquo;s just informative.</li>
</ul></li>
</ul>

<aside class="notice">There are specific rules to request a capture with boarding fee, available on item &ldquo;Total capture and partial&rdquo;</aside>

<h3 id="avs-(address-verification-service)">AVS (Address Verification Service)</h3>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;requisicao-transacao</span> <span class="na">id=</span><span class="s">"a97ab62a-7956-41ea-b03f-c2e9f612c293"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;dados-pedido&gt;</span>
    <span class="nt">&lt;numero&gt;</span>178148599<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;valor&gt;</span>10000<span class="nt">&lt;/valor&gt;</span>
    <span class="nt">&lt;moeda&gt;</span>986<span class="nt">&lt;/moeda&gt;</span>
    <span class="nt">&lt;data-hora&gt;</span>2011-12-07T11:43:37<span class="nt">&lt;/data-hora&gt;</span>
    <span class="nt">&lt;descricao&gt;</span>[origem:10.50.54.156]<span class="nt">&lt;/descricao&gt;</span>
    <span class="nt">&lt;idioma&gt;</span>PT<span class="nt">&lt;/idioma&gt;</span>
    <span class="nt">&lt;soft-descriptor&gt;</span>softdescriptor<span class="nt">&lt;/soft-descriptor&gt;</span>
    <span class="nt">&lt;taxa-embarque&gt;</span>1000<span class="nt">&lt;/taxa-embarque&gt;</span>
    <span class="nt">&lt;avs&gt;</span>
    <span class="cp">&lt;![CDATA[
      &lt;dados-avs&gt;</span>
        <span class="nt">&lt;endereco&gt;</span>Rua Teste AVS<span class="nt">&lt;/endereco&gt;</span>
        <span class="nt">&lt;complemento&gt;</span>Casa<span class="nt">&lt;/complemento&gt;</span>
        <span class="nt">&lt;numero&gt;</span>123<span class="nt">&lt;/numero&gt;</span>
        <span class="nt">&lt;bairro&gt;</span>Vila AVS<span class="nt">&lt;/bairro&gt;</span>
        <span class="nt">&lt;cep&gt;</span>12345-123<span class="nt">&lt;/cep&gt;</span>
      <span class="nt">&lt;/dados-avs&gt;</span>
    ]]&gt;
    <span class="nt">&lt;/avs&gt;</span>
  <span class="nt">&lt;/dados-pedido&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;/requisicao-transacao&gt;</span>
</code></pre>

<ul>
<li><strong>Purpose</strong>: AVS is a service to card transaction not presencial where is realized a register validation through numeric data of address informed by holder (shipping/delivery address on invoice) at online store, with register data of emitter.

<ul>
<li>AVS is a service that helps to reduce risks of lack of recognition at online shopping. It&rsquo;s a establishment tool to analyze your sales, before decide for transaction capture and product shipping or service.</li>
</ul></li>
<li><strong>Rules</strong>

<ul>
<li>Available just for Visa, Mastercard and Amex issuers.</li>
<li>Products allowed: only credit.</li>
<li>The consult returned to AVS is separated in two itens: CEP and address.</li>
<li>Each one can have the values following:</li>
<li>C- Check;</li>
<li>N- Not check;</li>
<li>U - unavailable</li>
<li>T - Temporarily unavailable</li>
<li>X - Service doesn’t supported by this card issuer</li>
<li>The node containing the XML of AVS must be encapsulated by &ldquo;CDATA&rdquo; term, to avoid problems with the parter of request.</li>
<li>All fields contained AVS node must be filled.</li>
<li>It&rsquo;s necessary enable the option AVS on the register. To enable an option AVS on the register or consult the participant banks please, contact Cielo E-commerce Web Support..</li>
</ul></li>
</ul>

<aside class="warning">According contract, this additional service is subjected to charge from the moment of the request for consulting AVS. For more information, please, contact our service center, commercial manager or Cielo E-commerce Web Support.</aside>

<h2 id="capture">Capture</h2>

<p>An authorized transaction only creates the credit for a commercial establishment in case being captured. That&rsquo;s why all sales that the retailer want effective must be necessary realize the capture (or confirmation).</p>

<p>For sales on Credit modality, this confirmation happens in two moments:</p>

<ul>
<li>Immediately after the authorization (total capture);</li>
<li>After the authorization (total capture or partial).</li>
</ul>

<p>In the first case, it&rsquo;s not necessary to send a request to capture, because it&rsquo;s done automatically by Cielo after the authorization of transaction. For this purpose, it&rsquo;s necessary configure the request of transaction defining the value &ldquo;true&rdquo; for a TAG <capturar>, according to section &ldquo;Creating a transaction&rdquo;.</p>

<p>In the second case, it&rsquo;s necessary to do a &ldquo;later capture&rdquo;, through the new request to Cielo Webservice to confirm the transaction and receive the sale value. </p>

<aside class="warning">The maximum time to realize the later capture is 5 continuous days after the authorization date. For example, if an authorization happens on 10/12 at 15h20m45s, the limit for a capture will be at 15h20m45s on 15/12.</aside>

<aside class="notice">This option doesn’t exist for debit modality: all debit transaction authorized is captured automatically.</aside>

<h3 id="catotal-and-partial-capture">CaTotal and Partial Capture</h3>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;requisicao-captura</span> <span class="na">id=</span><span class="s">"0374f305-0e23-4aad-82a2-055788c8cf4d"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;tid&gt;</span>10069930690360EF1001<span class="nt">&lt;/tid&gt;</span>
  <span class="nt">&lt;dados-ec&gt;</span>
    <span class="nt">&lt;numero&gt;</span>1006993069<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;chave&gt;</span>25fbb99741c739dd84d7b06ec78c9bac718838630f30b112d033ce2e621b34f3<span class="nt">&lt;/chave&gt;</span>
  <span class="nt">&lt;/dados-ec&gt;</span>
  <span class="nt">&lt;valor&gt;</span>10000<span class="nt">&lt;/valor&gt;</span>
  <span class="nt">&lt;taxa-embarque&gt;</span>1000<span class="nt">&lt;/taxa-embarque&gt;</span>
<span class="nt">&lt;/requisicao-captura&gt;</span>

</code></pre>

<ul>
<li><strong>Purpose</strong>: realize total and partial capture of a transaction previously authorized.</li>
<li><strong>Rules</strong>

<ul>
<li>Available only to transaction on the timeout maximum of capture.</li>
<li>In case of the amount doesn&rsquo;t be informed, the system will assume the capture of total value.</li>
<li>The capture value must be lower or equal to authorization value.</li>
<li>In case of failure, new capture tries can be done.</li>
<li>In case of success, the status is chaged to &ldquo;6 - Captured&rdquo;.</li>
<li><strong>Transaction with boarding fees:</strong></li>
<li>On the request capture, the boarding fee indicates the total of amount that will be captured that must be destined to this purpose.</li>
<li>It&rsquo;s mandatory in case of partial capture.</li>
<li>In case of total capture, the system will consider the value of boarding fee informed to request of authorization (<code class="prettyprint">&lt;requisicao-transacao&gt;</code>).</li>
</ul></li>
</ul>

<h3 id="return">Return</h3>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;transacao</span> <span class="na">xmlns=</span><span class="s">"http://ecommerce.cbmp.com.br"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span> <span class="na">id=</span><span class="s">"0378c8cf4d"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;tid&gt;</span>10069930690360EF1001<span class="nt">&lt;/tid&gt;</span>
  <span class="nt">&lt;pan&gt;</span>uv9yI5tkhX9jpuCt+dfrtoSVM4U3gIjvrcwMBfZcadE=<span class="nt">&lt;/pan&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;captura&gt;</span>
    <span class="nt">&lt;codigo&gt;</span>6<span class="nt">&lt;/codigo&gt;</span>
    <span class="nt">&lt;mensagem&gt;</span>Transacao capturada com sucesso<span class="nt">&lt;/mensagem&gt;</span>
    <span class="nt">&lt;data-hora&gt;</span>2011-12-08T14:23:08.779-02:00<span class="nt">&lt;/data-hora&gt;</span>
    <span class="nt">&lt;valor&gt;</span>900<span class="nt">&lt;/valor&gt;</span>
    <span class="nt">&lt;taxa-embarque&gt;</span>900<span class="nt">&lt;/taxa-embarque&gt;</span>
  <span class="nt">&lt;/captura&gt;</span>
<span class="nt">&lt;/transacao&gt;</span>
</code></pre>

<p>The field of node <code class="prettyprint">&lt;captura&gt;</code> are detailed below:</p>

<table><thead>
<tr>
<th>Element</th>
<th>Type</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>captura</td>
<td></td>
<td></td>
<td>Node with capture data in case that it has been passed for this step.</td>
</tr>
<tr>
<td>captura.codigo</td>
<td>Numérico</td>
<td>1..2</td>
<td>Processing code</td>
</tr>
<tr>
<td>captura.mensagem</td>
<td>Alfanumérico</td>
<td>1..100</td>
<td>Processing details</td>
</tr>
<tr>
<td>captura.datahora</td>
<td>Alfanumérico</td>
<td>19</td>
<td>Date and time of processing.</td>
</tr>
<tr>
<td>captura.valor</td>
<td>Numérico</td>
<td>1..12</td>
<td>Processing value without points. The last two numbers are “centavos”</td>
</tr>
<tr>
<td>captura.taxa-embarque</td>
<td>Numérico</td>
<td>1..9</td>
<td>Montante declarado como taxa de embarque que foi capturado.</td>
</tr>
</tbody></table>

<h2 id="cancellation">Cancellation</h2>

<p>The cancellation is used when the retailer decides for don&rsquo;t effective a purchase order, because the stock is not enough, because the customer gave up, ot any other reason. Its usage is necessary especially if the transaction has been captured, because there will be a debit on holder&rsquo;s invoice if it won&rsquo;t be cancelled.</p>

<aside class="notice">If the transaction is just authorized and the store eant to cancell it, the cancellation order it&rsquo;s not necessary, because after the timeout of capture expires, it will be cancelled automatically by the system.</aside>

<h3 id="total-and-partial-cancellation">Total and Partial Cancellation</h3>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;requisicao-cancelamento</span> <span class="na">id=</span><span class="s">"13368079-dedc-4cdf-9140-84473faf83d4"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;tid&gt;</span>100699306903613D1001<span class="nt">&lt;/tid&gt;</span>
  <span class="nt">&lt;dados-ec&gt;</span>
    <span class="nt">&lt;numero&gt;</span>1006993069<span class="nt">&lt;/numero&gt;</span>
    <span class="nt">&lt;chave&gt;</span>25fbb99741c739dd84d7b06ec78c9bac718838630f30b112d033ce2e621b34f3
<span class="nt">&lt;/chave&gt;</span>
  <span class="nt">&lt;/dados-ec&gt;</span>
  <span class="nt">&lt;valor&gt;</span>200<span class="nt">&lt;/valor&gt;</span>
<span class="nt">&lt;/requisicao-cancelamento&gt;</span>
</code></pre>

<ul>
<li><strong>Purpose</strong>: Realize the cancellation of total or partial value of a transaction.</li>
<li><strong>Rules</strong>

<ul>
<li>The total cancellation is valid for captured transaction, and also for authorized ones, the partial is valid just to the captured ones.</li>
<li>The cancellation timeout is until 120 current days to credit modality and D+0 to debt.</li>
<li>The total cancellation, when realzed with success changes the transaction status to &ldquo;9-Cancelled&rdquo;, while the partial doesn&rsquo;t change the transaction status, keeping it as &ldquo;6-Captured&rdquo;.</li>
<li>If the TAG <code class="prettyprint">&lt;valor&gt;</code> doesn&rsquo;t be provided, the system will assume the total cancellation.</li>
<li>To Amex issuer it&rsquo;s available just the total cancellation.</li>
<li>To debit modality, doesn&rsquo;t exist the possibility of effective the partial cancellation.</li>
<li><strong>Transaction with boarding fees:</strong></li>
<li>Captured transactions with the same authorization value (in other words, total capture), have the same treatment for total and partial cancellation, becaus de boarding fee value is fully cancelled.</li>
</ul></li>
</ul>

<table><thead>
<tr>
<th>Element</th>
<th>Type</th>
<th>Mandatory</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>tid</td>
<td>Alfanumérico</td>
<td>Sim</td>
<td>1..40</td>
<td>Transaction identifier</td>
</tr>
<tr>
<td>dados-ec.numero</td>
<td>Numérico</td>
<td>Sim</td>
<td>1..10</td>
<td>Store credential number</td>
</tr>
<tr>
<td>dados-ec.chave</td>
<td>Alfanumérico</td>
<td>Sim</td>
<td>1..100</td>
<td>Store access key assigned by Cielo</td>
</tr>
<tr>
<td>valor</td>
<td>Numérico</td>
<td>Opcional</td>
<td>1..12</td>
<td>Value to be cancelled. If not being informed, it will be a total concellation.</td>
</tr>
</tbody></table>

<h4 id="return">Return</h4>
<pre><code class="highlight xml"><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="nt">&lt;transacao</span> <span class="na">xmlns=</span><span class="s">"http://ecommerce.cbmp.com.br"</span> <span class="na">versao=</span><span class="s">"1.2.1"</span> <span class="na">id=</span><span class="s">"2c18f00a-3ff6-4c85-8865-a4fde599b2b2"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;tid&gt;</span>100699306903613E1001<span class="nt">&lt;/tid&gt;</span>
  <span class="nt">&lt;pan&gt;</span>uv9yI5tkhX9jpuCt+dfrtoSVM4U3gIjvrcwMBfZcadE=<span class="nt">&lt;/pan&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;cancelamentos&gt;</span>
    <span class="nt">&lt;cancelamento&gt;</span>
      <span class="nt">&lt;codigo&gt;</span>9<span class="nt">&lt;/codigo&gt;</span>
      <span class="nt">&lt;mensagem&gt;</span>Transacao cancelada com sucesso<span class="nt">&lt;/mensagem&gt;</span>
      <span class="nt">&lt;data-hora&gt;</span>2011-12-08T16:46:35.109-02:00<span class="nt">&lt;/data-hora&gt;</span>
      <span class="nt">&lt;valor&gt;</span>1000<span class="nt">&lt;/valor&gt;</span>
    <span class="nt">&lt;/cancelamento&gt;</span>
  <span class="nt">&lt;/cancelamentos&gt;</span>
<span class="nt">&lt;/transacao&gt;</span>
</code></pre>

<aside class="notice">The cancellations (partial or total) of transaction with boarding fee and partial capture are not be accepted automatically by the system.</aside>

<h1 id="testing-and-homologation">Testing and homologation</h1>

<h2 id="endpoint">Endpoint</h2>

<p>The integrating tests must be realized before the homologation starts, during the development (codification) of solution. For this purpose, you must considered an enviroment like EndPoint to Webservice: <a href="https://qasecommerce.cielo.com.br/servicos/ecommwsec.do">https://qasecommerce.cielo.com.br/servicos/ecommwsec.do</a></p>

<aside class="warning">All the connections to Cielo services must be done through the URL mentioned on this documentation. Cielo strongly recommend you don&rsquo;t  use the direct connection via IP, because it can vary without previously notice.</aside>

<h2 id="testing-data">Testing data</h2>

<p>The data gross to realize the tests on this environment will be displayed on table below:</p>

<table><thead>
<tr>
<th>Card issuer</th>
<th>Authentication</th>
<th>Testing number card</th>
<th>Validity</th>
<th>Secure code - - CVC</th>
</tr>
</thead><tbody>
<tr>
<td>Visa</td>
<td>Yes</td>
<td>4012001037141112</td>
<td>05/2018</td>
<td>123</td>
</tr>
<tr>
<td>Mastercard</td>
<td>Yes</td>
<td>5453010000066167</td>
<td>05/2018</td>
<td>123</td>
</tr>
<tr>
<td>Visa</td>
<td>No</td>
<td>4012001038443335</td>
<td>05/2018</td>
<td>123</td>
</tr>
<tr>
<td>Mastercard</td>
<td>No</td>
<td>5453010000066167</td>
<td>05/2018</td>
<td>123</td>
</tr>
<tr>
<td>Amex</td>
<td>No</td>
<td>376449047333005</td>
<td>05/2018</td>
<td>123</td>
</tr>
<tr>
<td>Elo</td>
<td>No</td>
<td>6362970000457013</td>
<td>05/2018</td>
<td>123</td>
</tr>
<tr>
<td>Diners</td>
<td>No</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Discover</td>
<td>No</td>
<td>6011020000245045</td>
<td>05/2018</td>
<td>123</td>
</tr>
<tr>
<td>JCB</td>
<td>No</td>
<td>3566007770004971</td>
<td>05/2018</td>
<td>123</td>
</tr>
<tr>
<td>Aura</td>
<td>No</td>
<td>5078601912345600019</td>
<td>05/2018</td>
<td>123</td>
</tr>
</tbody></table>

<h2 id="testing-key">Testing key</h2>

<p>To make easier the development we provided two key for tests, one for each modality of integration. Based on initial configurations done on your registration, choose the correct data to realize the tests:</p>

<table><thead>
<tr>
<th>Commercial establishment number</th>
<th>Testing key</th>
</tr>
</thead><tbody>
<tr>
<td>1006993069</td>
<td>25fbb99741c739dd84d7b06ec78c9bac718838630f30b112d033ce2e621b34f3</td>
</tr>
</tbody></table>

<aside class="warning">The order value, besides to follow the format without points or decimal commas, must finish on &ldquo;00&rdquo;, otherwise, the authorization will be always denied. Example: R$15,00 must be formated as &ldquo;1500&rdquo;.</aside>

<aside class="notice">The testing environment must be used by testing establishments listed on the board above. The data usage of the establishment will create transaction impossible to track, creating incorrect results. On testing environment, use the credential for tests, on production environment, use the original data from establishment.</aside>

<p>After conclude the development, the Homologation step will ensure that the implementation was appropriate and the customer solution is ready to interact with production environment of Cielo. It&rsquo;s always happens after the development has been finished and tested. It&rsquo;s composed by the next steps:</p>

<p><img alt="fluxo testes" src="images/fluxo-testes.png" /></p>

<ol>
<li>Conclusion of Registration: at this stage, the customer must send an email to <a href="mailto:cieloecommerce@cielo.com.br">cieloecommerce@cielo.com.br</a>, requesting a production key. The message will contain the next information, that will complete the registration:

<ul>
<li>Definitive URL of website (production environment).</li>
<li>Name of responsible company by the development of integration.</li>
<li>Name and technical email (responsible developer) by integration.</li>
<li>Credential number (at Cielo) of online store.</li>
<li>Legal name and fictitious name of online store.</li>
</ul></li>
</ol>

<aside class="notice">The logo image must be hosted in a safety environment (HTTP), otherwise the customer will receive security notification that can culminate on shopping abandonment.</aside>

<p>In response, Cielo will return the valid key on production environment. Therefore, the store will be enable to realize tests on this environment. It starts the second step. It&rsquo;s important that the tests be realized to cover the next topics:</p>

<ul>
<li>Webservice interact: tests with the connection that you use.</li>
<li>Visual integration: round trip of Cielo flow (an alternative flow must be considered).</li>
<li>Correct payment modalities: tests with possible combination of payment.</li>
</ul>

<p>At this moment, you have to consider the environment: <a href="https://ecommerce.cielo.com.br/servicos/ecommwsec.do">https://ecommerce.cielo.com.br/servicos/ecommwsec.do</a></p>

<aside class="notice">The online store integration must be done always through the URL above and never for IP. </aside>

<p>Production tests have to be done with card that belongs to the store or which holder authorized its usage, once in this environment exists a financial commitment about transaction realized.</p>

<p>At the end, a new request must be sent to cieloecommerce@cielo.com.br, to Cielo realize the homologation, indeed. The mass of tests will be executed to approve or deny the transactions.</p>

<p>The result &ldquo;homologated&rdquo; will be sent by e-mail. If there is any point that doesn&rsquo;t allow the conclusion of homologation, the information will be also sent by e-mail requesting the corrections that are necessary.</p>

<h1 id="final-considerations">Final considerations</h1>

<h2 id="reading-rules-to-store&#39;s-card">Reading rules to store&rsquo;s card</h2>

<p>The reading of card data on own environment is controlled by rules defined by security program imposed by card issuers.</p>

<p>For Visa, this program is known as AIS (Account Information Security) PCI. To more information, access: <a href="www.cielo.com.br">www.cielo.com.br</a> &gt; Service &gt; Security Service &gt; AIS - Information Security Program or contact us.</p>

<p>For Mastercard, the security program is SDP (Site Data Protection) PCI. For more information, access:  <a href="http://www.mastercard.com/us/sdp/index.html">http://www.mastercard.com/us/sdp/index.html</a>, or contact us.</p>

<p>Moreover, once requests are attended, at the credential (register) on e-commerce website, must be mentioned the option for reading the card from your own store.</p>

<p>Digital Certificate</p>

<p>In some environment is necessary extract the Digital Certificate that the Cielo E-commerce application uses to be installed on TrustStore of customer, specially in Java and PHP environments.</p>

<p>o obtain the certificate, please, open a browser and access:  <a href="http://ecommerce.cielo.com.br">http://ecommerce.cielo.com.br</a>; click on the icon that displays the information about the certificate:</p>

<p><strong>Google Chrome</strong>:</p>

<p><img alt="Certificado no Google Chrome" src="images/certificado-chrome.png" /></p>

<p><strong>Mozilla Firefox</strong>:</p>

<p><img alt="Certificado no Mozilla Firefox" src="images/certificado-firefox.png" /></p>

<p><strong>Internet Explorer</strong>:</p>

<p><img alt="Certificado no Internet Explorer" src="images/certificado-ie.png" /></p>

<p>Verified Program by Visa (Visa)</p>

<p>International Program of Visa allows the customer authentication at the purchase moment on e-commerce environment. Visit: http://www.verifiedbyvisa.com.br/  to more information.</p>

<p>Secure Code Program (Mastercard)</p>

<p>International Program of Mastercard allows the customer authentication at the purchase moment on e-commerce environment. Visit: <a href="http://www.verifiedbyvisa.com.br/">http://www.verifiedbyvisa.com.br/</a> to more information.</p>

<h1 id="appendix">Appendix</h1>

<h2 id="transaction-statuses">Transaction statuses</h2>

<table><thead>
<tr>
<th>Status</th>
<th>Code</th>
</tr>
</thead><tbody>
<tr>
<td>Created transaction</td>
<td>0</td>
</tr>
<tr>
<td>Transaction in progress</td>
<td>1</td>
</tr>
<tr>
<td>Authenticated transaction</td>
<td>2</td>
</tr>
<tr>
<td>Unauthenticated transaction</td>
<td>3</td>
</tr>
<tr>
<td>Authorized transaction</td>
<td>4</td>
</tr>
<tr>
<td>Unauthorized transaction</td>
<td>5</td>
</tr>
<tr>
<td>Transaction captured</td>
<td>6</td>
</tr>
<tr>
<td>Transaction in authentication</td>
<td>10</td>
</tr>
<tr>
<td>Transaction in cancellation</td>
<td>12</td>
</tr>
</tbody></table>

<h2 id="eci">ECI</h2>

<table><thead>
<tr>
<th>Authentication result</th>
<th>Visa</th>
<th>Mastercard</th>
<th>Aura</th>
<th>Other</th>
</tr>
</thead><tbody>
<tr>
<td>Holder identified with success.</td>
<td>5</td>
<td>2</td>
<td>n/d</td>
<td>n/d</td>
</tr>
<tr>
<td>Holder didn&rsquo;t authentication, because the emitter didn&rsquo;t provided authentication mechanisms.</td>
<td>6</td>
<td>1</td>
<td>n/d</td>
<td>n/d</td>
</tr>
<tr>
<td>Holder doesn&rsquo;t authenticated with success, because of unexpected technical error.</td>
<td>7</td>
<td>1</td>
<td>n/d</td>
<td>n/d</td>
</tr>
<tr>
<td>Holder doesn&rsquo;t authenticated with success.</td>
<td>70</td>
<td>n/d</td>
<td>n/d</td>
<td></td>
</tr>
<tr>
<td>The store has chosen authorize without pass for the authentication.</td>
<td>7</td>
<td>0</td>
<td>0</td>
<td>7</td>
</tr>
</tbody></table>

            </div>
            <div class="dark-box">
                <div class="lang-selector">
                    <a href="#" data-language-name="xml">XML</a>
                </div>
            </div>
        </div>
    </body>
    </html>
